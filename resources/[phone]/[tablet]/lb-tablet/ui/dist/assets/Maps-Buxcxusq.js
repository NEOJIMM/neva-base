import{u as v,r as c,U as w,ae as o,h as l,k as z,G as x,S as _,j as i,a as u,af as A,ag as I,ah as y,ai as k,aj as E,ak as b,al as j,am as U,f as G,N as O}from"./index-B-vcvQz_.js";function D(){var f;const e=v(G),n=(f=v(O))==null?void 0:f.active,[r,d]=c.useState("satellite"),[m,L]=c.useState([254,21]),[M,C]=c.useState([]);c.useEffect(()=>{if(!w("Maps")||!(e!=null&&e.Locations)&&!(n!=null&&n.data))return;(async()=>{l("Maps",{action:"getLocations"}).then(s=>{s||(s=[]);const p=(n==null?void 0:n.data)&&{position:n.data.location,name:n.data.name,icon:n.data.icon,description:n.data.description,size:[35,35]},h=[];let g=0;e==null||e.Locations.forEach(a=>{E(a.icon,T=>{h.push({position:[a.position.y,a.position.x],name:a.name,description:a.description,icon:T?a.icon:"./assets/img/icons/maps/mappin.png"}),g++,g===e.Locations.length&&C([...s,p,...h].filter(Boolean))})})})})()},[e,n]),c.useEffect(()=>{if((window==null?void 0:window.chrome)!==void 0){const t=o.GridLayer.prototype._initTile;o.GridLayer.include({_initTile:function(s){t.call(this,s);const p=this.getTileSize();s.style.width=`${p.x+1}px`,s.style.height=`${p.y+1}px`}})}return l("Maps",{action:"toggleUpdateCoords",toggle:!0}),()=>{l("Maps",{action:"toggleUpdateCoords"})}},[]),z("maps:updateCoords",t=>{var s;if(!t)return x("warning","Received empty data from maps:updateCoords");if((s=_.value)!=null&&s.airplaneMode)return x("info","Airplane mode is enabled, can't update coords");L([t.y,t.x])});const S=t=>{t&&l("Maps",{action:"setWaypoint",data:{x:t[1],y:t[0]}})},N=new o.Icon({iconUrl:"./assets/img/icons/maps/pin.svg",popupAnchor:[-0,-0],iconSize:[30,30]});return i("div",{className:"maps-container",children:i("div",{className:"map-wrapper",children:u(A,{className:"map",crs:q,center:[0,0],zoom:3,minZoom:3,maxZoom:6,bounceAtZoomLimits:!0,maxBoundsViscosity:.95,maxBounds:[[9e3,-5700],[-4500,6500]],preferCanvas:!0,boxZoom:!1,children:[i(Z,{location:m}),i(I,{url:`https://loaf-scripts.com/fivem/lb-phone/map/${r}/{z}/{x}/{y}.png`}),M.map((t,s)=>{if(t)return i(y,{position:t.position,icon:B(t.icon),children:i(k,{children:u("div",{className:"location-popup",children:[i("div",{className:"name",children:t.name}),i("div",{className:"description",children:t.description}),i("div",{className:"button",onClick:()=>S(t.position),children:"GO"})]})})},s)}),!m.includes(0,1)&&i(y,{position:m,icon:N})]})})})}const Z=({location:e})=>{const n=b();return u("div",{className:"options",children:[i(j,{}),i(U,{onClick:()=>n.panTo(e)})]})},B=(e,n)=>new o.Icon({iconUrl:e??"./assets/img/icons/maps/mappin.png",popupAnchor:[-0,-0],iconSize:[25,25]}),P=117.3,R=172.8,$=.02072,W=.0205,q=o.extend({},o.CRS.Simple,{projection:o.Projection.LonLat,scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/.6931471805599453},distance:function(e,n){var r=n.lng-e.lng,d=n.lat-e.lat;return Math.sqrt(r*r+d*d)},transformation:new o.Transformation($,P,-W,R),infinite:!0});export{D as default};
