import{u as w,r as d,U as V,$ as l,G as u,h as S,j as t,F as M,a as c,m as g,n as E,c as X,H as j,a0 as b,L as h,a1 as H,J as K,I as $,a2 as q,a3 as G,g as D,a4 as J,K as R,a5 as W,a6 as Y}from"./index-B-vcvQz_.js";const z={tablet:[{id:"414",title:"Citation",content:`Citation for Benefactor Kriger

Plate: 4X4X4X4

Offence: Speeding

Fine: $500`},{id:"1661",title:"Police Briefing",content:`Today we will be focusing on the following:

- Traffic stops
- Drug busts
- Bank robberies`}],phone:[{id:"123",title:"Shopping List",content:"Milk, eggs, bread, butter",updated_at:Date.now()-1e3*60*60*2},{id:"1414",title:"To Do List",content:`- Finish the UI
- Implement the backend
- Deploy the app`,updated_at:Date.now()-1e3*60*60*5},{id:"51515",title:"another list",content:`this is yet another list, it functions as a test for the notes app.

You can add new notes, edit them, and delete them.`,updated_at:Date.now()-1e3*60*60*24*2}]},o=R([]);function Z(){var A;const L=w(Y),r=w(o),[s,N]=d.useState(null),[i,P]=d.useState("tablet"),[f,_]=d.useState(""),[k,m]=d.useState(!1),[I,p]=d.useState(!1),[T,O]=d.useState(0);d.useEffect(()=>{if(V("Notes")){if(O(0),p(!1),m(!1),o.set([]),l.APPS.NOTES.notes.value&&l.APPS.NOTES.notes.value.length>0&&i==="tablet"){u("info","Using cached notes, not fetching",l.APPS.NOTES.notes.value),o.set(l.APPS.NOTES.notes.value);return}u("info","Fetching notes, from device: ",i),S("Notes",{action:"fetch"},z[i],i==="phone").then(e=>{if(!e)return u("warning","Failed to fetch notes, server returned false");u("info","Fetched notes",e),o.set(e),i==="tablet"&&l.APPS.NOTES.notes.set(e)})}},[i]),d.useEffect(()=>{P("tablet")},[s]);const F=()=>{if(I||k)return;let e=document.querySelector("#last");if(!e)return;!W(e)&&(m(!0),S("Notes",{action:"fetch",page:T+1},null).then(n=>{n&&n.length>0?(u("info","Fetched notes from progressive scrolling",n),o.set([...r,...n]),l.APPS.NOTES.notes.set([...r,...n]),m(!1),n.length<15&&p(!0)):p(!0),O(T+1)}))},y=()=>{let e=Math.floor(Date.now()),a={title:h("APPS.NOTES.NEW_NOTE"),content:"",updated_at:e};S("Notes",{action:"create",data:a},!0).then(n=>{a.id=n,N(a),o.set([...r,a]),l.APPS.NOTES.notes.set([...r,a])})},x=e=>{let a=Math.floor(Date.now()),n=[...r],C=n.findIndex(U=>U.id===e),v=n[C];v={id:s.id,title:s.title,content:s.content,updated_at:a},n[C]=v,S("Notes",{action:"save",data:v},!0),N(null),o.set(n),l.APPS.NOTES.notes.set(n)},B=e=>{S("Notes",{action:"remove",id:e},!0).then(a=>{if(!a)return u("warning","Could not remove note with id: "+e);u("info","Successfully removed note with id: "+e),N(null),o.set(o.value.filter(n=>n.id!==e)),l.APPS.NOTES.notes.set(o.value.filter(n=>n.id!==e))})};return t(M,{children:t("div",{className:"notes-container",children:s?c(g.div,{...E("right","note",.2),className:"notes-wrapper note",children:[c("div",{className:"top",children:[c("div",{className:"back",onClick:()=>x(s.id),children:[t(K,{}),h("APPS.NOTES.TITLE")]}),t($,{className:"title",defaultValue:s.title,onChange:e=>N({...s,title:e.target.value})}),t("div",{})]}),t(q,{onChange:e=>N({...s,content:e.target.value}),defaultValue:s.content}),c("div",{className:"notes-bottom",children:[t("div",{className:"action left",children:t(G,{onClick:()=>D.PopUp.set({title:h("APPS.NOTES.DELETE_TITLE",{title:s.title}),description:h("APPS.NOTES.DELETE_TEXT",{title:s.title}),buttons:[{title:h("APPS.NOTES.BUTTON_CANCEL")},{title:h("APPS.NOTES.BUTTON_DELETE"),color:"red",cb:()=>B(s.id)}]})})}),t("div",{className:"amount",children:h("APPS.NOTES.LAST_EDITED",{date:b(s.updated_at)})}),t("div",{className:"action",children:t(J,{onClick:()=>{D.Share.set({type:"note",data:s})}})})]})]}):c(g.div,{...E("left","notes",.2),className:"notes-wrapper ",children:[c("div",{className:"notes-header",children:[t("div",{className:"title",children:"Notes"}),L&&t("div",{className:"selector",children:["tablet","phone"].map((e,a)=>t("div",{onClick:()=>P(e),className:"option","data-active":i===e,children:X(e)},a))})]}),t(j,{placeholder:"Search notes",onChange:e=>_(e.target.value)}),t("div",{className:"notes-body",onScroll:F,children:t(g.div,{...E(i==="tablet"?"left":"right",i,.2),className:"notes-list",children:r.filter(e=>{var a,n;return((a=e.title)==null?void 0:a.toLowerCase().includes(f==null?void 0:f.toLowerCase()))||((n=e.content)==null?void 0:n.toLowerCase().includes(f==null?void 0:f.toLowerCase()))}).sort((e,a)=>a.updated_at-e.updated_at).map((e,a)=>{let n=a===r.length-1?"last":"";return c("div",{id:n,className:"note-item",onClick:()=>N(e),children:[t("div",{className:"note-title",children:e.title}),c("div",{className:"note-details",children:[t("div",{className:"date",children:b(e.updated_at)}),t("div",{className:"content",children:e.content.length>30?e.content.slice(0,30)+"...":e.content})]})]},a)})})}),c("div",{className:"notes-bottom",children:[t("div",{}),t("div",{className:"amount",children:h("APPS.NOTES.FOOTER",{amount:(A=r.length)==null?void 0:A.toString()})}),t("div",{className:"action",children:t(H,{onClick:()=>y()})})]})]})})})}export{Z as default};
