import{u as N,r as P,U as Y,h as p,G as g,j as e,F as T,a as i,L as n,m as b,a_ as ae,b as J,a$ as ne,b0 as ie,g as A,b1 as se,o as ce,b2 as le,f as F,k as $,J as oe,b3 as w,b4 as re,I as de,b5 as W,b6 as me,an as X,a5 as z,b7 as Se,N as q,a8 as B,S as Q,a6 as ue,H as Ee,b8 as K,b9 as Pe,K as x,ba as Z,bb as he,ac as ee,aD as pe,q as ve,bc as Ie,bd as ge,n as Ne}from"./index-B-vcvQz_.js";const _={companies:[{job:"police",name:"Police",icon:"https://cdn-icons-png.flaticon.com/512/7211/7211100.png",canCall:!0,canMessage:!0,bossRanks:["boss","lieutenant"],open:!0,location:{name:"Mission Row",coords:{x:428.9,y:-984.5}}},{job:"ambulance",name:"Ambulance",icon:"https://cdn-icons-png.flaticon.com/128/1032/1032989.png",canCall:!0,canMessage:!0,bossRanks:["boss","doctor"],open:!0,location:{name:"Pillbox",coords:{x:304.2,y:-587}}},{job:"mechanic",name:"Mechanic",icon:"https://cdn-icons-png.flaticon.com/128/10281/10281554.png",canCall:!0,canMessage:!0,bossRanks:["boss","worker"],open:!1,location:{name:"LS Customs",coords:{x:-336.6,y:-134.3}}},{job:"taxi",name:"Taxi",icon:"https://cdn-icons-png.flaticon.com/128/433/433449.png",canCall:!0,canMessage:!0,bossRanks:["boss","driver"],open:!1,location:{name:"Taxi HQ",coords:{x:984.2,y:-219}}}],company:{job:"police",duty:!0,receiveCalls:!0,isBoss:!0,balance:1e6,employees:[{id:1,name:"Breze",grade:1,gradeLabel:"Officer",canInteract:!0,online:!0},{id:2,name:"Loaf Scripts",grade:2,gradeLabel:"Sergeant",canInteract:!0,online:!0},{id:3,name:"Kash",grade:3,gradeLabel:"Lieutenant",canInteract:!0,online:!1}],grades:[{label:"Officer",grade:1},{label:"Sergeant",grade:2},{label:"Lieutenant",grade:3},{label:"Captain",grade:4}]},messageList:[{id:"1",lastMessage:"Is anyone available to help me?",sender:"Breze",number:"1234567890",company:{name:"Police",icon:"https://cdn-icons-png.flaticon.com/512/7211/7211100.png"},timestamp:Date.now()-1e3*60*60*2},{id:"2",lastMessage:"Hello, how can i help you?",sender:"Loaf Scripts",number:"4802940940",company:{name:"Police",icon:"https://cdn-icons-png.flaticon.com/512/7211/7211100.png"},timestamp:Date.now()-1e3*60*60*4},{id:"3",lastMessage:"Hey, i need backup at the bank",sender:"Sally",number:"2051440412",company:{name:"Police",icon:"https://cdn-icons-png.flaticon.com/512/7211/7211100.png"},timestamp:Date.now()-1e3*60*60*24*2}],messages:{1:[{id:"1",sender:"1234567890",isSender:!1,content:"Is anyone available to help me?",timestamp:Date.now()-1e3*60*60*2},{id:"2",sender:"1234567323",isSender:!0,content:"Hey, a unit is on its way to your location",timestamp:Date.now()-1e3*60*60*24*2},{id:"3",sender:"1234567890",isSender:!1,content:"i'd like to report a crime, i'm at the pier",timestamp:Date.now()-1e3*60*60*24*2}],2:[{id:"1",sender:"4802940940",content:"Hey, can you help me?",timestamp:Date.now()-1e3*60*60*4},{id:"2",sender:"4802940940",content:"I need a unit to my location",timestamp:Date.now()-1e3*60*60*24*5},{id:"3",sender:"4802940940",content:"I need backup at the bank",timestamp:Date.now()-1e3*60*60*24*9}],3:[{id:"1",sender:"2051440412",content:"is there any way you have any job positions available?",timestamp:Date.now()-1e3*60*60*24*2},{id:"2",sender:"2051440412",content:"hello?",timestamp:Date.now()-1e3*60*60*24*4},{id:"3",sender:"2051440412",content:"hey, i have a question",timestamp:Date.now()-1e3*60*60*24*5}]},employees:[{firstname:"John",lastname:"Doe",grade:1,gradeLabel:"Officer",number:"1234567890",online:!0},{firstname:"Loaf",lastname:"Scripts",grade:2,gradeLabel:"Sergeant",number:"4802940940",online:!0},{firstname:"Kash",grade:3,gradeLabel:"Lieutenant",number:"2051440412",online:!1},{firstname:"Sally",grade:4,gradeLabel:"Captain",number:"1234567323",online:!0}]};function Ce(){var o,c,u,v,I,O,L,M,U,S,h,C,D;const t=N(F),[a,l]=P.useState(null),[m,s]=P.useState(null);P.useEffect(()=>{Y("Services")&&p("Services",{action:"getCompany"},_.company).then(d=>{if(!d)return g("warning","Failed to fetch company data");l(d)})},[]);const r=()=>{A.PopUp.set({title:n("APPS.SERVICES.DEPOSIT_POPUP.TITLE"),description:n("APPS.SERVICES.DEPOSIT_POPUP.DESCRIPTION"),input:{placeholder:n("APPS.SERVICES.DEPOSIT_POPUP.AMOUNT"),onChange:d=>{s(d)},type:"number"},buttons:[{title:n("APPS.SERVICES.DEPOSIT_POPUP.CANCEL")},{title:n("APPS.SERVICES.DEPOSIT_POPUP.PROCEED"),cb:()=>{s(d=>{/^\d+$/.test(d)&&p("Services",{action:"depositMoney",amount:parseInt(d)},parseInt(d)+a.balance).then(f=>{if(typeof f!="number")return g("warning","Balance is not a number, not updating");l({...a,balance:f})})})}}]})},E=()=>{A.PopUp.set({title:n("APPS.SERVICES.WITHDRAW_POPUP.TITLE"),description:n("APPS.SERVICES.WITHDRAW_POPUP.DESCRIPTION"),input:{placeholder:n("APPS.SERVICES.WITHDRAW_POPUP.AMOUNT"),onChange:d=>{s(d)},type:"number"},buttons:[{title:n("APPS.SERVICES.WITHDRAW_POPUP.CANCEL")},{title:n("APPS.SERVICES.WITHDRAW_POPUP.PROCEED"),cb:()=>{s(d=>{if(/^\d+$/.test(d)){if(a.balance-parseInt(d)<0){A.PopUp.set({title:n("APPS.SERVICES.WITHDRAW_POPUP.TITLE"),description:n("APPS.SERVICES.WITHDRAW_POPUP.NOT_ENOUGH_MONEY",{amount:d}),buttons:[{title:n("APPS.SERVICES.WITHDRAW_POPUP.PROCEED")}]});return}p("Services",{action:"withdrawMoney",amount:parseInt(d)},a.balance-parseInt(d)).then(f=>{if(typeof f!="number")return g("warning","Balance is not a number, not updating");l({...a,balance:f})})}})}}]})};return e(T,{children:a!=null&&a.job?i("div",{className:"actions-container",children:[e("div",{className:"category-title",children:n("APPS.SERVICES.SETTINGS")}),e("section",{children:i(T,{children:[a.duty!==void 0&&((c=(o=t==null?void 0:t.Services)==null?void 0:o.Management)==null?void 0:c.Duty)!==!1&&i(b.div,{initial:{opacity:0,scale:.9},whileInView:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"item",children:[i("div",{className:"item-data",children:[e(ae,{className:"orange"}),i("div",{className:"item-info",children:[e("div",{className:"title",children:n("APPS.SERVICES.DUTY")}),e("div",{className:"description",children:n("APPS.SERVICES.DUTY_DESCRIPTION")})]})]}),e("div",{className:"item-value",children:e(J,{checked:a.duty,onChange:()=>{p("Services",{action:"toggleDuty",duty:!a.duty},!0).then(()=>l({...a,duty:!a.duty}))}})})]}),(a.duty===void 0||a.duty===!0)&&a.receiveCalls!==void 0&&i(b.div,{initial:{opacity:0,scale:.9},whileInView:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"item",children:[i("div",{className:"item-data",children:[e(ne,{className:"green"}),i("div",{className:"item-info",children:[e("div",{className:"title",children:n("APPS.SERVICES.JOB_CALLS")}),i("div",{className:"description",children:[" ",n("APPS.SERVICES.JOB_CALLS_DESCRIPTION",{toggle:a.receiveCalls?n("APPS.SERVICES.DISABLE"):n("APPS.SERVICES.ENABLE")})]})]})]}),e("div",{className:"item-value",children:e(J,{checked:a.receiveCalls,onChange:()=>{p("Services",{action:"toggleCalls"},!a.receiveCalls).then(d=>{l({...a,receiveCalls:d})})}})})]})]})}),a.isBoss&&i(T,{children:[e("div",{className:"category-title",children:n("APPS.SERVICES.ACTIONS")}),i("section",{children:[i(b.div,{initial:{opacity:0,scale:.9},whileInView:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"item",children:[i("div",{className:"item-data",children:[e(ie,{className:"green"}),i("div",{className:"item-info",children:[e("div",{className:"title",children:n("APPS.SERVICES.BALANCE")}),e("div",{className:"description",children:n("APPS.SERVICES.CURRENT_BALANCE")})]})]}),e("div",{className:"item-value",children:t.CurrencyFormat.replace("%s",(u=a.balance)==null?void 0:u.toLocaleString())})]}),(((I=(v=t==null?void 0:t.Services)==null?void 0:v.Management)==null?void 0:I.Deposit)!==!1||((L=(O=t==null?void 0:t.Services)==null?void 0:O.Management)==null?void 0:L.Withdraw)!==!1)&&i("div",{className:"item",children:[((U=(M=t==null?void 0:t.Services)==null?void 0:M.Management)==null?void 0:U.Deposit)!==!1&&e("div",{className:"button",onClick:r,children:n("APPS.SERVICES.DEPOSIT_POPUP.TITLE")}),((h=(S=t==null?void 0:t.Services)==null?void 0:S.Management)==null?void 0:h.Withdraw)!==!1&&e("div",{className:"button",onClick:E,children:n("APPS.SERVICES.WITHDRAW_POPUP.TITLE")})]})]}),e("div",{className:"category-title",children:n("APPS.SERVICES.MANAGE_EMPLOYEES")}),i("section",{children:[((D=(C=t==null?void 0:t.Services)==null?void 0:C.Management)==null?void 0:D.Hire)!==!1&&i(b.div,{initial:{opacity:0,scale:.9},whileInView:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"item",onClick:()=>{A.PopUp.set({title:n("APPS.SERVICES.HIRE_POPUP.TITLE"),description:n("APPS.SERVICES.HIRE_POPUP.DESCRIPTION"),input:{type:"number",placeholder:n("APPS.SERVICES.HIRE_POPUP.PLACEHOLDER"),onChange:d=>{s(d)}},buttons:[{title:n("APPS.SERVICES.HIRE_POPUP.CANCEL")},{title:n("APPS.SERVICES.HIRE_POPUP.PROCEED"),cb:()=>{s(d=>{if(/^\d+$/.test(d))return p("Services",{action:"hireEmployee",source:parseInt(d)},{id:d,name:"Joe Doe"}).then(f=>{f&&l({...a,employees:[...a.employees,{id:f.id,name:f.name,grade:0,gradeLabel:a.grades[0].label,canInteract:!0}]})}),""})}}]})},children:[i("div",{className:"item-data",children:[e(se,{className:"blue"}),i("div",{className:"item-info",children:[e("div",{className:"title",children:n("APPS.SERVICES.HIRE")}),e("div",{className:"description",children:n("APPS.SERVICES.HIRE_POPUP.DESCRIPTION")})]})]}),e("div",{className:"item-value",children:e(ce,{})})]}),a.employees.map((d,f)=>i(b.div,{initial:{opacity:0,scale:.9},whileInView:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"item",onClick:()=>{if(!d.canInteract||t.Services.Management.Fire===!1&&t.Services.Management.Promote===!1)return;const te=[t.Services.Management.Promote!==!1&&{title:n("APPS.SERVICES.SET_GRADE"),cb:()=>{setTimeout(()=>{A.ContextMenu.set({buttons:[...a.grades.map(R=>({title:R.label,cb:()=>{p("Services",{action:"setGrade",employee:d.id,grade:R.grade},!0).then(j=>{if(!j)return g("warning","Failed to set grade");l({...a,employees:a.employees.map(k=>(k.id===d.id&&(k.grade=R.grade,k.gradeLabel=R.label),k))})})}}))]})},300)}},t.Services.Management.Fire!==!1&&{title:n("APPS.SERVICES.FIRE_POPUP.TITLE"),color:"red",cb:()=>{A.PopUp.set({title:n("APPS.SERVICES.FIRE_POPUP.TITLE"),description:n("APPS.SERVICES.FIRE_POPUP.DESCRIPTION",{name:d.name}),buttons:[{title:n("APPS.SERVICES.FIRE_POPUP.CANCEL")},{title:n("APPS.SERVICES.FIRE_POPUP.PROCEED"),color:"red",cb:()=>{p("Services",{action:"fireEmployee",employee:d.id},!0).then(R=>{if(!R)return g("warning","Failed to fire employee");l({...a,employees:a.employees.filter(j=>j.id!==d.id)})})}}]})}}];A.ContextMenu.set({buttons:te.filter(R=>R)})},children:[i("div",{className:"item-data",children:[e(le,{}),i("div",{className:"item-info",children:[e("div",{className:"title",children:d.name}),i("div",{className:"description",children:[" ",d.gradeLabel]})]})]}),e("div",{className:"item-value",children:e("div",{className:"status","data-online":d.online})})]},f))]})]})]}):e("div",{className:"no-job",children:n("APPS.SERVICES.UNEMPLOYED")})})}function fe(){const t=N(Q),a=N(y),l=N(ue),[m,s]=P.useState([]);P.useState(0);const[r,E]=P.useState(!1),[o,c]=P.useState(!1),u=P.useRef(null),[v,I]=P.useState({content:"",attachments:[]});P.useEffect(()=>{p("Services",{action:"getMessages",id:a.id,company:a.job},_.messages[a.id]).then(S=>{if(S&&S.length>0){s([...S.reverse()]);let h=document.querySelector(".chat-container");h.scrollTop=h.scrollHeight}else E(!0)})},[]);const O=()=>{if(!l)return g("warning","Cannot send message without a phone");if(v.content.length>0){let S={id:a.id,company:a.job,isSender:!0,content:v.content,timestamp:new Date};if(t.airplaneMode)return s(h=>[...h,{...S,delivered:!1}]);p("Services",{action:"sendMessage",...S},!0,!0).then(h=>{h||g("error","Failed to send message"),s(C=>[...C,{...S,delivered:h}]),I({content:"",attachments:[]}),u.current.value=""})}},L=()=>{A.PopUp.set({title:n("APPS.MESSAGES.SEND_LOCATION_POPUP.TITLE"),description:n("APPS.MESSAGES.SEND_LOCATION_POPUP.TEXT"),buttons:[{title:n("APPS.MESSAGES.SEND_LOCATION_POPUP.CANCEL")},{title:n("APPS.MESSAGES.SEND_LOCATION_POPUP.SEND"),cb:()=>{p("Maps",{action:"getCurrentLocation"},{x:"0",y:"0"}).then(S=>{if(!S)return g("error","Failed to get location");let h={content:`<!SENT-LOCATION-X=${X(S.x,2)}Y=${X(S.y,2)}!>`,attachments:[],isSender:!0,id:a.id,company:a.job,timestamp:new Date};p("Services",{action:"sendMessage",...h},!0,!0).then(C=>{s(C?D=>[...D,h]:D=>[...D,{...h,delivered:!1}])})})}}]})},M=()=>{if(r||o)return;let S=document.querySelector("#last");if(!S)return;!z(S)&&(c(!0),p("Services",{action:"getMessages",id:a.id,company:a.job,lastId:m[0].id},null).then(C=>{C&&C.length>0?(s([...C.reverse(),...m]),c(!1),C.length<25&&E(!0)):E(!0)}))};$("services:newMessage",S=>{if(a.id!==S.channelId||S.isSender||t.airplaneMode)return;s([...m,{...S,timestamp:new Date}]);let h=document.querySelector(".chat-container");h.scrollTop=h.scrollHeight});const U=S=>{if(S)return/<!SENT-LOCATION-X=(-?\d*\.?\d*)Y=(-?\d*\.?\d*)!>/.test(S)};return i(T,{children:[i("div",{className:"chat-header",children:[e("div",{className:"back",onClick:()=>{V.set("messages"),y.reset()},children:e(oe,{})}),i("div",{className:"user",children:[e("img",{src:`./assets/img/icons/avatar-placeholder-${t.display.theme}.svg`,className:"avatar"}),e("div",{className:"name",children:w(a.number)})]}),e(re,{className:"hidden"})]}),e("div",{className:"chat-container",onScroll:M,children:e("div",{className:"chat-body",children:m.map((S,h)=>e(Ae,{index:h,messages:m,message:S,func:{isLocation:U}}))})}),e("div",{className:"chat-bottom",children:i("div",{className:"input",children:[e(de,{placeholder:n("APPS.MESSAGES.PLACEHOLDER"),ref:u,value:v.content,disabled:!l,onChange:S=>{I({content:S.target.value,attachments:v.attachments})},onClick:()=>{if(!l)return g("warning","Cannot send message without a phone")},onKeyDown:S=>{S.key=="Enter"&&O()}}),i("div",{className:"buttons",children:[e("div",{className:"location",children:e(W,{onClick:L})}),v.content.length>0&&l&&e("div",{className:"send",onClick:O,children:e(me,{})})]})]})})]})}const Ae=({messages:t,message:a,index:l,func:m})=>{var O;const s=N(y);let r=s.number,E,o,c,u=l===0?"last":"",v=(a==null?void 0:a.sender)===r?"other":"self",I=((O=t[l+1])==null?void 0:O.sender)===r?"other":"self";if(t[l+1]?o=Math.abs(a.timestamp-t[l+1].timestamp)/36e5:I=void 0,m.isLocation(a.content)){let L=a.content.match(/X=(-?\d*\.?\d*)Y/)[1],M=a.content.match(/Y=(-?\d*\.?\d*)!>/)[1];c={x:L,y:M}}return i("div",{className:`message ${v}`,id:u,"data-id":a.id,children:[E,a.delivered===!1?i("div",{className:"content-wrapper",children:[e("div",{className:"content",children:a.content}),e(Se,{})]}):c?i("div",{className:"location",onClick:()=>{q.patch({active:{name:"Maps",data:{location:[c.y,c.x],name:`${w(a.sender)}'s location`,icon:s.icon}}})},children:[e("div",{className:"img",style:{backgroundImage:'url("https://img.gta5-mods.com/q95/images/mirror-park-garden/2b72f9-20160428154103_1.jpg")'}}),v==="other"&&i("div",{className:"sender",children:[w(a.sender)," ",n("APPS.MESSAGES.SENT_LOCATION")]})]}):a.content&&e("div",{className:"content",children:a.content}),a.delivered===!1?e("div",{className:"status",children:n("APPS.MESSAGES.NOT_DELIVERED")}):t[l+1]&&o>6?e("div",{className:"date",children:B(a.timestamp)}):v!==I&&e("div",{className:"date",children:B(a.timestamp)})]},l)},H=x(null);function be(){var r,E;const t=N(H),[a,l]=P.useState("all"),[m,s]=P.useState("");return i(b.div,{initial:{opacity:0,y:250},animate:{opacity:1,y:0},exit:{opacity:0,y:250},transition:{duration:.2,ease:"easeInOut"},className:"employee-list",children:[i("div",{className:"employee-list-header",children:[e("div",{className:"close",onClick:()=>H.set(null)}),e("div",{className:"selector",children:["all","available"].map((o,c)=>e("div",{className:"option","data-active":a===o,onClick:()=>l(o),children:n(`APPS.SERVICES.${o.toUpperCase()}`)},c))}),e(Ee,{placeholder:n("APPS.SERVICES.SEARCH_EMPLOYEES"),onChange:o=>s(o.target.value)})]}),e("div",{className:"employee-list-body",children:(E=(r=t==null?void 0:t.filter(o=>(a==="all"?!0:o.online)&&K(o.firstname,o.lastname).toLowerCase().includes(m.toLowerCase())))==null?void 0:r.sort((o,c)=>c.grade-o.grade))==null?void 0:E.map((o,c)=>e(b.div,{initial:{opacity:0,scale:.9},whileInView:{opacity:1,scale:1},viewport:{once:!0},className:"employee-item",children:i("div",{className:"user",children:[e("div",{className:"avatar",children:Pe(o.firstname,o.lastname)}),i("div",{className:"info",children:[K(o.firstname,o.lastname),e("span",{children:o.gradeLabel})]})]})},c))})]})}function Oe(){var m;const[t,a]=P.useState([]),l=(m=N(q))==null?void 0:m.active;return P.useEffect(()=>{Y("Services")&&p("Services",{action:"getCompanies"},_.companies).then(s=>{if(!s)return g("warning","Failed to fetch companies");a(s)})},[l]),$("services:updateOpen",s=>{if(!s)return;const{job:r,open:E}=s;a(o=>{const c=o.findIndex(u=>u.job===r);return c===-1?o:(o[c].open=E,[...o])})}),e(T,{children:e("div",{className:"companies-list",children:t.sort((s,r)=>s.open&&!r.open?-1:!s.open&&r.open?1:0).map(s=>e(Re,{company:s},s.name))})})}const Re=({company:t})=>{var r,E,o;N(F);const[a,l]=P.useState(!1),m=()=>{p("Services",{action:"getEmployees",company:t.job},_.employees).then(c=>{if(!c)return g("warning","You do not have permission to view employees.");H.set(c)})},s=c=>{var u;!((u=c==null?void 0:c.location)!=null&&u.coords)||!c.name||q.patch({active:{name:"Maps",data:{location:[c.location.coords.y,c.location.coords.x],name:c.name,icon:c.icon}}})};return i("div",{className:"item",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),"data-open":t.open,onClick:m,children:[i("div",{className:"info",children:[t.icon&&e("div",{className:"icon",children:e("img",{src:t.icon})}),i("div",{className:"company-details",children:[e("div",{className:"title",children:t.name}),i("div",{className:"location",children:[e(Z,{}),(r=t.location)==null?void 0:r.name]})]})]}),t.open?i("div",{className:"actions",children:[t.customIcon&&e("div",{className:"custom-icon",onClick:c=>{c.stopPropagation(),p("Services",{action:"customIconClick",company:t.job})},children:he[t.customIcon]()}),((E=t.location)==null?void 0:E.coords)&&e(W,{className:"orange",onClick:c=>{c.stopPropagation(),s(t)}})]}):i(T,{children:[e("div",{className:"actions",onMouseEnter:()=>l(!1),onMouseLeave:()=>l(!0),children:((o=t.location)==null?void 0:o.coords)&&e(W,{className:"orange",onClick:c=>{c.stopPropagation(),s(t)}})}),e(ee,{children:a&&e(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeInOut"},className:"closed",children:n("APPS.SERVICES.CLOSED")})})]})]},t.name)};function ye(){const[t,a]=P.useState([]),[l,m]=P.useState(!1),[s,r]=P.useState(!1),[E,o]=P.useState(0);P.useEffect(()=>{Y("Services")&&p("Services",{action:"getRecentMessages"},_.messageList).then(u=>{if(!u)return g("warning","No recent messages found");a(u)})},[]);const c=()=>{if(s||l)return;let u=document.querySelector("#last");if(!u)return;!z(u)&&(m(!0),p("Services",{action:"getRecentMessages",page:E+1},null).then(I=>{I&&I.length>0?(g("info","Fetched services recentMessages from progressive scrolling",I),a([...I,...I]),m(!1),I.length<15&&r(!0)):r(!0),o(E+1)}))};return $("services:channelDeleted",u=>{if(!u)return g("error","No channel ID provided");a(t.filter(v=>v.id!==u))}),e(T,{children:e("div",{className:"company-messages-container",onScroll:c,children:e("section",{children:t&&t.map((u,v)=>{let I=v===t.length-1?"last":"";return e(Te,{id:I,channel:u},v)})})})})}const Te=({channel:t,last:a})=>{const l=N(Q),m=pe(()=>{var r;(r=F)!=null&&r.value.Services.DeleteConversations&&A.ContextMenu.set({buttons:[{title:n("APPS.MESSAGES.DELETE_CONVERSATION.TITLE"),color:"red",cb:()=>{setTimeout(()=>{A.PopUp.set({title:n("APPS.MESSAGES.DELETE_CONVERSATION.TITLE"),description:n("APPS.MESSAGES.DELETE_CONVERSATION.DESCRIPTION"),buttons:[{title:n("APPS.MESSAGES.DELETE_CONVERSATION.CANCEL")},{title:n("APPS.MESSAGES.DELETE_CONVERSATION.DELETE"),color:"red",cb:()=>{p("Services",{action:"deleteChannel",id:t.id},!0).then(E=>{if(!E)return g("error","Failed to delete channel, deleteChannel returned false")})}}]})},100)}}]})}),s=r=>{if(r)return/<!SENT-LOCATION-X=(-?\d*\.?\d*)Y=(-?\d*\.?\d*)!>/.test(r)};return i("div",{...m,id:a,className:"item",onClick:()=>{var r;y.set({...y==null?void 0:y.value,id:t.id,company:w(t.number),job:(r=t.company)==null?void 0:r.job,number:t.number}),V.set("chat")},children:[e("img",{src:`./assets/img/icons/avatar-placeholder-${l.display.theme}.svg`}),i("div",{className:"info",children:[i("div",{className:"info-header",children:[e("div",{className:"user",children:w(t.number)}),i("div",{className:"right",children:[e("div",{className:"time",children:B(t.timestamp)}),e(ve,{})]})]}),e("div",{className:"message",children:s(t.lastMessage)?n("APPS.MESSAGES.SENT_LOCATION_SHORT"):t.lastMessage})]})]})},G=x([{icon:e(Z,{}),title:n("APPS.SERVICES.COMPANIES"),value:"companies"}]);function Le(){const t=N(F),a=N(V),l=N(G);return P.useEffect(()=>{var m,s;G.set([...G.value,t.LBPhone&&{icon:e(Ie,{}),title:n("APPS.SERVICES.MESSAGES"),value:"messages"},((s=(m=t==null?void 0:t.Services)==null?void 0:m.Management)==null?void 0:s.Enabled)!==!1&&{icon:e(ge,{}),title:n("APPS.SERVICES.ACTIONS"),value:"actions"}].filter(r=>r!==null).filter((r,E,o)=>o.findIndex(c=>(c==null?void 0:c.value)===(r==null?void 0:r.value))===E))},[]),e("div",{className:"companies-footer",children:l.map((m,s)=>i("div",{className:"item","data-active":a===m.value,onClick:()=>V.set(m.value),children:[m.icon,m.title]},s))})}const V=x("companies"),y=x(null);function De(){const t=N(V),a=N(H),l={companies:e(Oe,{}),actions:e(Ce,{}),messages:e(ye,{}),chat:e(fe,{})};let m={actions:n("APPS.SERVICES.ACTIONS"),messages:n("APPS.SERVICES.MESSAGES"),companies:n("APPS.SERVICES.COMPANIES")};return i("div",{className:"companies-container","data-view":t,children:[e(ee,{children:a&&e(be,{})}),i(b.div,{...Ne(t==="chat"?"left":"right",t,.2),className:"companies-wrapper",children:[t!=="chat"&&e("div",{className:"companies-header",children:e("div",{className:"title",children:m[t]})}),e("div",{className:"companies-body",children:l[t]})]}),t!=="chat"&&e(Le,{})]})}export{y as Data,V as View,De as default};
