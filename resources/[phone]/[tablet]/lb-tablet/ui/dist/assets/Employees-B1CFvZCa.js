import{u as C,r as c,h as O,G as f,k as S,j as a,m as k,a as r,L as o,H as L,bh as x,bD as T,bM as I,g as A,b3 as M,K as R,bF as m}from"./index-B-vcvQz_.js";const u=R([]);function w(){var h,E;const N=C(u),[p,b]=c.useState([]),[l,g]=c.useState({}),[d,P]=c.useState("police"),[n,v]=c.useState("");return c.useEffect(()=>{O("Police",{action:"getEmployees"},{employees:m.employees,ranks:m.ranks,labels:m.labels}).then(e=>{if(!e)return f("warning","No employees returned from server");u.set(e.employees),b(e.ranks),g(e.labels),P(Object.keys(e.labels)[0])})},[]),S("police:updateCallsign",e=>{if(!e)return f("error","No data received for police:updateCallsign");u.set(i=>{const s=i.findIndex(t=>t.id===e.identifier);return s===-1?i:(i[s].callsign=e.callsign,[...i])})}),a(k.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{ease:"easeInOut",duration:.25},className:"policepage-container",children:a("main",{className:"main offences",children:r("div",{className:"page",children:[r("div",{className:"top",children:[a("div",{className:"title",children:o("APPS.POLICE.EMPLOYEES.TITLE")}),Object.keys(l).length>1&&a("div",{className:"selector",children:Object.keys(l).sort((e,i)=>l[e].localeCompare(l[i])).map(e=>a("div",{className:"option","data-active":d===e,onClick:()=>P(e),children:l[e]},e))})]}),a(L,{placeholder:o("APPS.POLICE.EMPLOYEES.SEARCH"),onChange:e=>v(e.target.value)}),a("div",{className:"items",children:(E=(h=p[d])==null?void 0:h.sort((e,i)=>i.grade-e.grade))==null?void 0:E.map(e=>{if(N.filter(s=>{var t;return s.rank===e.grade&&s.job===d&&((t=s==null?void 0:s.name)==null?void 0:t.toLowerCase().includes(n==null?void 0:n.toLowerCase()))}).length>0)return r("div",{className:"grid-item",children:[a("div",{className:"top",children:a("div",{className:"title",children:e.label})}),a("div",{className:"items",style:{padding:"0 0.5rem"},children:N.filter(s=>s.rank===e.grade&&s.job===d).filter(s=>{var t;return(t=s==null?void 0:s.name)==null?void 0:t.toLowerCase().includes(n==null?void 0:n.toLowerCase())}).map((s,t)=>r("div",{className:"item profile",children:[a("div",{className:x("status",s.onDuty?"online":"offline")}),a("img",{src:T(s.avatar,"profile")}),r("div",{className:"info",children:[a("div",{className:"name",children:s.name}),a("div",{className:"subtitle",children:s.callsign}),s.phoneNumber&&a("div",{className:"phone",onClick:()=>{I(s.phoneNumber),A.PopUp.set({title:o("COMPONENTS.SHARE.COPY_POPUP.TITLE"),description:o("COMPONENTS.SHARE.COPY_POPUP.DESCRIPTION"),buttons:[{title:o("COMPONENTS.SHARE.COPY_POPUP.OK")}]})},children:M(s.phoneNumber)})]})]},t))})]},e.grade)})})]})})})}export{w as default};
